#!/usr/bin/make -f
# -*- makefile -*-
# Sample debian/rules that uses debhelper.
# This file was originally written by Joey Hess and Craig Small.
# As a special exception, when this file is copied by dh-make into a
# dh-make output file, you may use that output file without restriction.
# This special exception was added by Craig Small in version 0.37 of dh-make.

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

MULTIARCH_DIR:=$(if $(shell dpkg-architecture -qDEB_HOST_MULTIARCH),$(shell dpkg-architecture -qDEB_HOST_MULTIARCH)/)

%:
	dh $@ --parallel

override_dh_auto_install: debian/egltrace.install debian/glxtrace.install
	dh_auto_install

clean:
	rm -f debian/egltrace.install debian/glxtrace.install
	dh clean
	find . -name '*.pyc' -print0 | xargs -0 rm -f

debian/changelog:
	rm -f debian/changelog
	debchange --distribution unstable --package apitrace --create --empty -v 0-"$$(date -ud "$$(git show '--pretty=format:%cD' | head -n1 )" "+%Y%m%d%H%M%S")~$$(git show '--pretty=format:%h' | head -n1 )" Dummy autogenerated changelog file.

tarball:
	git archive  -o ../apitrace_0.orig.tar HEAD
	gzip -9 ../apitrace_0.orig.tar

%.install: %.install.ma
	sed -e 's @MA@ ${MULTIARCH_DIR} g'  > $@ < $<

changelog:

.PHONY: clean debian/changelog
